<h1 class="title">
  <i class="fa-solid fa-file-medical"></i>
  Exame
</h1>

<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <fieldset>
    <legend>Dados</legend>

    <div class="flex-row">
      <div class="flex-column">
        <div class="form-group">
          <label for="patient">Paciente</label>
          <select formControlName="patient" name="patient" id="patient">
            <option disabled selected value="">Selecione um paciente</option>
            @for (patient of patients; track patient.id) {
            <option value="{{ patient.id }}">{{ patient.name }}</option>
            }
          </select>
        </div>
        <div class="container-errors">
          <div
            class="error"
            *ngIf="
              form.get('patient')?.hasError('required') &&
              form.get('patient')?.touched
            "
          >
            <i class="fa-solid fa-circle-exclamation"></i>
            Obrigatório
          </div>
        </div>
      </div>

      <div class="flex-column">
        <div class="form-group">
          <label for="exam-name">Nome do exame</label>
          <input
            formControlName="examName"
            type="text"
            name="exam-name"
            id="exam-name"
            placeholder="Digite o nome"
          />
        </div>
        <div class="container-errors">
          <div
            class="error"
            *ngIf="
              form.get('examName')?.hasError('required') &&
              form.get('examName')?.touched
            "
          >
            <i class="fa-solid fa-circle-exclamation"></i>
            Obrigatório
          </div>

          <div
            class="error"
            *ngIf="form.get('examName')?.hasError('minlength')"
          >
            <i class="fa-solid fa-circle-exclamation"></i>
            No mínimo 2 caracteres
          </div>

          <div class="error" *ngIf="form.get('examName')?.hasError('pattern')">
            <i class="fa-solid fa-circle-exclamation"></i>
            Apenas letras e números
          </div>
        </div>
      </div>
    </div>

    <div class="flex-row">
      <div class="flex-column">
        <div class="form-group">
          <label for="exam-type">Tipo de exame</label>
          <select formControlName="examType" name="exam-type" id="exam-type">
            <option disabled selected value="">Selecione um tipo</option>
            <option value="laboratorial">Laboratorial</option>
          </select>
        </div>
        <div class="container-errors">
          <div
            class="error"
            *ngIf="
              form.get('examType')?.hasError('required') &&
              form.get('examType')?.touched
            "
          >
            <i class="fa-solid fa-circle-exclamation"></i>
            Obrigatório
          </div>
        </div>
      </div>

      <div class="flex-column">
        <div class="form-group">
          <label for="value">Valor particula</label>
          <input
            formControlName="value"
            type="number"
            name="value"
            id="value"
            placeholder="Digite o valor"
          />
        </div>
        <div class="container-errors">
          <div
            class="error"
            *ngIf="
              form.get('value')?.hasError('required') &&
              form.get('value')?.touched
            "
          >
            <i class="fa-solid fa-circle-exclamation"></i>
            Obrigatório
          </div>

          <div class="error" *ngIf="form.get('value')?.hasError('min')">
            <i class="fa-solid fa-circle-exclamation"></i>
            No mínimo 1
          </div>
        </div>
      </div>
    </div>

    <div class="flex-row">
      <div class="form-group">
        <label for="description">Descrição</label>
        <textarea
          formControlName="description"
          name="description"
          id="description"
          placeholder="Digite a descrição"
        ></textarea>
      </div>

      <div class="flex-column">
        <div class="form-group">
          <label for="materials">Materiais utilizados</label>
          <select formControlName="materials" name="materials" id="materials">
            <option disabled selected value="">Selecione um tipo</option>
            @for (material of materials; track material.id) {
            <option value="{{ material.id }}">{{ material.name }}</option>
            }
          </select>
        </div>
        <div class="container-errors">
          <div
            class="error"
            *ngIf="
              form.get('materials')?.hasError('required') &&
              form.get('materials')?.touched
            "
          >
            <i class="fa-solid fa-circle-exclamation"></i>
            Obrigatório
          </div>
        </div>
      </div>
    </div>
  </fieldset>

  <div class="container-form-buttons">
    <app-clear-button></app-clear-button>
    <app-register-button></app-register-button>
  </div>
</form>
